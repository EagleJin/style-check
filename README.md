# [https://github.com/EagleJin/style-check](https://github.com/EagleJin/style-check)
---

因为遇到过太多次现网重大故障，程序崩溃是由于一些低级错误引发的，而这些错误早已在编译时由编译器报告了。由于没有统一的代码规范，没有有效的工具检测规范，前期的代码规范没有推行成功。

为了使统一的代码的规范真正落地，我们使用阿里发布的Java代码规范检测插件P3C-PMD，同时把该jar与Gitlab结合，强制执行规范检查。

但是对于一些历史版本，系统已经稳定运行了很多年，即便存在一些严重告警和隐患，研发团队也不愿意投入时间和精力去修复这些故障，大多数研发团队信奉的原则是：只要系统没有坏，就不要去碰它。这当然是有一定道理的，

然而目标是希望所有项目都统一规范，所以我们基于Gitlab的钩子机制，定制了一些检查规则。

1. 只扫描提交的文件
2. 只扫描提交文件修改行上下3行左右范围的代码
3. 基于老项目克隆的新项目第一次提交时不检查
4. 跟第三方对接使用工具生成的代码放到指定的包路径下，放过检查

这样对历史项目的改动检查影响不大，大家基本都可以接受。  
同时基本不影响项目的快速交付

